<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn Breakpoints in JS</title>
</head>
<body>
    <h3>Learn Breakpoints in JS</h3>
    <h3>Get random fact about cats</h3>
    <button id="cat">Get New Fact</button>
    <p id="fact"></p>

    <div>
        <h3>Get Random Dog Image</h3>
        <button id="dog">Get new image</button><br><br>
        <img src="" width="300" height="auto">
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
    
    <script>
        //---------------- Learn about breakpoints in browser
        // function one(){
        //     return 1;
        // }
        // function two(){
        //     return one() + one();
        // }
        // function three(){
        //     let sum=two() + one();
        //     console.log(sum);
        // }
        // three();

        //----------------- Callback Hell
        // let h3=document.querySelector("h3");
        // function changeColor(color, delay, nextcolorchange){
        //     setTimeout( () => {
        //         h3.style.color=color;
        //         if(nextcolorchange) nextcolorchange();
        //     },delay)
        // }
        // changeColor("red", 1000, () => {
        //     changeColor("blue", 1000, ()=>{
        //         changeColor("green", 1000, () => {
        //             changeColor("Orange", 1000);
        //         });
        //     });
        // });

        //----------------- CallBack Hell, Optimize it using Promise. 
        // function storeData(data, success, failer){
        //     let speed=Math.floor((Math.random() * 10)+1);
        //     if(speed > 4){
        //         success();
        //     }
        //     else{
        //         failer();
        //     }
        // }

        // storeData("Sohail", 
        // ()=> {
        //     console.log("Success1: Data is saved in Database.");
        //     storeData("Hello Sohail",
        //     ()=>{
        //         console.log("Success2: Second data is saved in DB")
        //     },
        //     ()=>{
        //         console.log("Failer: Second Data is not Saved.")
        //     })
        // }, 
        // ()=>{
        //     console.log("Data is not saved!!");
        // });

        // Optimize Callback Hell using promise
        function storeToDB(data){
            return new Promise((resolve, reject)=> {
                let netspeed=Math.floor((Math.random()*10) + 1);
                if(netspeed > 4){
                    resolve("Success: Data was saved");
                }
                else{
                    reject("Failur: Weak Connection");
                }
            });
        }


        // let request=storeToDB("Sohail Mumtaz");
        // request
        // .then( () => {
        //     console.log("Promise was resolved.")
        // })
        // .catch(() => {
        //     console.log("Promise was rejected.")
        // });

        // Request alternative Direct method
        storeToDB("Sohail Mumtaz")
        .then( () => {
            console.log("Promise was resolved.")
            return storeToDB("Promise Chaining");
        })
        .then(() => {
            console.log("Second Promise resolved.");
        })
        .catch(() => {
            console.log("Promise was rejected.")
        });


        // async funtion 
        async function greet() {
            return "Hello World";
        }
        // API Send Request
        let url="https://catfact.ninja/fact";
        fetch(url)
        .then((res)=> {
            return res.json();
        })
        .then((data)=>{
            console.log("Data1: ", data.fact);
            return fetch(url)
        })
        .then((res2)=>{
            return res2.json();
        })
        .then((data2)=>{
            console.log("Data2: ", data2.fact);
        })
        
        .catch((err)=>{
            console.log(err);
        })

        // Practise about Axios
        async function getFact(){
            try{
                let res= await axios.get(url);
                return res.data.fact;
            }catch(e){
                console.log(e);
                return "No Fact Found"
            }
        }

        // Random fact about cats
        let btnFact=document.querySelector("#cat");
        let newFact=document.querySelector("#fact");

        btnFact.addEventListener("click", async()=>{
            let catfact= await getFact();
            newFact.innerText=catfact;
        });

        // Random dog Image
        let dogApi="https://dog.ceo/api/breeds/image/random";
        let btnDog=document.querySelector("#dog");
        let dogImg=document.querySelector("img");

        btnDog.addEventListener("click", async ()=>{
            dogImg.src=await getDog();
        })
        async function getDog(){
            try{
                let resDogApi=await axios.get(dogApi);
                return resDogApi.data.message;
            }catch(e){
                return "/"
            }
        }
        // Get Random Joke : Send data in API Header
        const jokeAPI="https://icanhazdadjoke.com/"
        async function getjoke(){
            try{
                const header={headers: {Accept: "application/json"} };
                let joke=await axios.get(jokeAPI, header);
                console.log(joke);

            }catch(e){
                console("Random Joke API Got an error: ", e);
            }
        }
        // Get list of Universities 
        const uniApi="http://universities.hipolabs.com/search?name=india"; 
        
        console.log(getUni());

        async function getUni(){
            try{
                let unidata=await axios.get(uniApi);
                return unidata;
            }
            catch(e){
                console.log("University API Erro: ", e);
                return [];
            }
        }




    </script>

</body>
</html>